<mujoco model="mycobot_280">
  <compiler angle="radian" coordinate="local" meshdir="meshes"/>
  <option gravity="0 0 -9.81" timestep="0.002" integrator="RK4"/>

  <!-- ================= DEFAULTS ================= -->
  <default>
    <!-- Visual meshes -->
    <default class="visual">
      <geom type="mesh" contype="0" conaffinity="0" density="50"/>
    </default>

    <!-- Collision capsules -->
    <default class="coll">
      <geom type="capsule"
            contype="1"
            conaffinity="1"
            friction="1 0.005 0.0001"
            density="300"/>
    </default>

    <joint damping="5" armature="0.05"/>
  </default>

  <!-- ================= ASSETS ================= -->
  <asset>
    <mesh name="mycobot_base" file="mycobot_base.stl"/>
    <mesh name="joint1" file="joint1.stl"/>
    <mesh name="joint2" file="joint2.stl"/>
    <mesh name="joint3" file="joint3.stl"/>
    <mesh name="joint4" file="joint4.stl"/>
    <mesh name="joint5" file="joint5.stl"/>
    <mesh name="joint6" file="joint6.stl"/>
    <mesh name="joint7" file="joint7.stl"/>

    <mesh name="camera" file="camera.stl"/>

    <mesh name="gripper_base" file="gripper_base.stl"/>
    <mesh name="gripper_left1" file="gripper_left1.stl"/>
    <mesh name="gripper_left2" file="gripper_left2.stl"/>
    <mesh name="gripper_left3" file="gripper_left3.stl"/>
    <mesh name="gripper_right1" file="gripper_right1.stl"/>
    <mesh name="gripper_right2" file="gripper_right2.stl"/>
    <mesh name="gripper_right3" file="gripper_right3.stl"/>
  </asset>

  <!-- ================= WORLD ================= -->
  <worldbody>

    <!-- Floor -->
    <geom name="floor"
          type="plane"
          pos="0 0 0"
          size="2 2 0.1"
          rgba="0.8 0.8 0.8 1"
          contype="1"
          conaffinity="1"/>

    <!-- Base -->
    <body name="mycobot_base" pos="0 0 -0.03" euler="1.5708 0 0">
      <geom class="visual" mesh="mycobot_base"/>

      <!-- Base collision -->
      <geom class="coll" fromto="0 0 0.02  0 0 0.08" size="0.06"/>

      <!-- Link 1 -->
      <body name="link1" pos="0 0 0.13156" euler="0 0 -1.5708">
        <joint name="joint1" type="hinge" axis="0 0 1" range="-2.93 2.93"/>
        <geom class="visual" mesh="joint1"/>
        <geom class="coll" fromto="0 0 0   0 0 0.10" size="0.035"/>

        <!-- Link 2 -->
        <body name="link2" euler="0 1.5708 -1.5708">
          <joint name="joint2" type="hinge" axis="0 0 1" range="-2.36 2.36"/>
          <geom class="visual" mesh="joint2"/>
          <geom class="coll" fromto="0 0 0   -0.09 0 0" size="0.03"/>

          <!-- Link 3 -->
          <body name="link3" pos="-0.1104 0 0">
            <joint name="joint3" type="hinge" axis="0 0 1" range="-2.62 2.62"/>
            <geom class="visual" mesh="joint3"/>
            <geom class="coll" fromto="0 0 0   -0.10 0 0" size="0.028"/>

            <!-- Link 4 -->
            <body name="link4" pos="-0.096 0 0.06462" euler="0 0 -1.5708">
              <joint name="joint4" type="hinge" axis="0 0 1" range="-2.53 2.53"/>
              <geom class="visual" mesh="joint4"/>
              <geom class="coll" fromto="0 0 0   -0.08 0 0.04" size="0.025"/>

              <!-- Link 5 -->
              <body name="link5" pos="0 -0.07318 0" euler="1.5708 -1.5708 0">
                <joint name="joint5" type="hinge" axis="0 0 1" range="-2.88 2.88"/>
                <geom class="visual" mesh="joint5"/>
                <geom class="coll" fromto="0 0 0   0 0.06 0" size="0.022"/>

                <!-- Link 6 -->
                <body name="link6" pos="0 0.0456 0" euler="-1.5708 0 0">
                  <joint name="joint6" type="hinge" axis="0 0 1" range="-3.14 3.14"/>
                  <geom class="visual" mesh="joint6"/>
                  <geom class="coll" fromto="0 0 0   0 0 0.05" size="0.02"/>

                  <!-- Link 7 -->
                  <body name="link7" pos="0 0 -0.038">
										<joint name="joint7" type="hinge" axis="0 0 1" range="-3.14159 3.14159"/>
										<geom class="visual" mesh="joint7"/>


                    <!-- Camera -->
                    <body name="camera" pos="0 0 0.01" euler="1.579 0 -2.3562">
                      <geom class="visual" mesh="camera"/>

                      <!-- Gripper base (NO COLLISIONS) -->
                      <body name="gripper_base" pos="0 0.041 0" euler="0 -1.57 0">
                        <geom class="visual" mesh="gripper_base"/>

                        <!-- Gripper bodies: visual only -->
                        <body name="gripper_left3" pos="-0.012 -0.002 0">
                          <joint name="gripper_controller" type="hinge" axis="0 0 1" range="-0.74 0.15"/>
                          <geom class="visual" mesh="gripper_left3"/>

                          <body name="gripper_left1" pos="-0.027 0.016 0">
                            <joint name="gripper_left1_joint" type="hinge" axis="0 0 1"/>
                            <geom class="visual" mesh="gripper_left1"/>
                          </body>
                        </body>

                        <body name="gripper_left2" pos="-0.005 0.0195 0">
                          <joint name="gripper_left2_joint" type="hinge" axis="0 0 1"/>
                          <geom class="visual" mesh="gripper_left2"/>
                        </body>

                        <body name="gripper_right3" pos="0.012 -0.002 0">
                          <joint name="gripper_right3_joint" type="hinge" axis="0 0 1"/>
                          <geom class="visual" mesh="gripper_right3"/>

                          <body name="gripper_right1" pos="0.027 0.016 0">
                            <joint name="gripper_right1_joint" type="hinge" axis="0 0 1"/>
                            <geom class="visual" mesh="gripper_right1"/>
                          </body>
                        </body>

                        <body name="gripper_right2" pos="0.005 0.0195 0">
                          <joint name="gripper_right2_joint" type="hinge" axis="0 0 1"/>
                          <geom class="visual" mesh="gripper_right2"/>
                        </body>

                        <site name="ee" pos="0 0.07 0" size="0.005"/>
                      </body>
                    </body>
                  </body>
                </body>
              </body>
            </body>
          </body>
        </body>
      </body>
    </body>
  </worldbody>

  <!-- ================= CONSTRAINTS ================= -->
  <equality>
    <weld body1="mycobot_base" body2="world"/>

    <joint joint1="gripper_controller" joint2="gripper_left2_joint" polycoef="0 1 0 0 0"/>
    <joint joint1="gripper_controller" joint2="gripper_left1_joint" polycoef="0 -1 0 0 0"/>
    <joint joint1="gripper_controller" joint2="gripper_right3_joint" polycoef="0 -1 0 0 0"/>
    <joint joint1="gripper_controller" joint2="gripper_right2_joint" polycoef="0 -1 0 0 0"/>
    <joint joint1="gripper_controller" joint2="gripper_right1_joint" polycoef="0 1 0 0 0"/>
  </equality>

  <!-- ================= ACTUATORS ================= -->
  <actuator>
    <motor joint="joint1" gear="50"/>
    <motor joint="joint2" gear="50"/>
    <motor joint="joint3" gear="50"/>
    <motor joint="joint4" gear="30"/>
    <motor joint="joint5" gear="20"/>
    <motor joint="joint6" gear="10"/>
    <motor joint="gripper_controller" gear="10"/>
  </actuator>
</mujoco>
